{% extends 'base.html' %}
{% block title %}Gallery{% endblock %}
{% block content %}
<form method="get" class="flex items-center space-x-2 mb-6 sticky top-0 bg-[#111827] p-4">
    <select name="filter" id="filterSelect" class="border rounded px-3 py-2 text-gray-800">
        <option value="">Search By</option>
        <option value="name">Name</option>
        <option value="date">Date</option>
        <option value="phone">Phone</option>
        <option value="details">Details</option>
    </select>
    <input type="text" id="searchInput" name="q" placeholder="Search..." class="border rounded px-3 py-2 text-gray-800">
    <button type="submit" class="bg-yellow-400 hover:bg-yellow-500 px-4 py-2 rounded font-semibold">Search</button>
</form>

<script>
    const filterSelect = document.getElementById('filterSelect');
    const searchInput = document.getElementById('searchInput');

    function updateInputType() {
        if (filterSelect.value === 'date') {
            searchInput.type = 'date';
            searchInput.placeholder = 'Select date';
        } else {
            searchInput.type = 'text';
            searchInput.placeholder = 'Search...';
        }
    }

    filterSelect.addEventListener('change', updateInputType);

    // Initialize on page load
    updateInputType();
</script>

<!-- Gallery -->

<h1 class="text-4xl font-bold text-center text-yellow-400 mb-8">Photo Gallery</h1>
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
    {% for img in images %}
    <a href="{% url 'image_detail' img.pk %}"
        class="block bg-gray-800 rounded-lg shadow-lg overflow-hidden hover:scale-105 transition">
        <img src="{{ img.image.url }}" alt="{{ img.title }}" class="w-full h-64 object-cover">
        <div class="p-4">
            <h2 class="text-lg font-semibold text-white">{{ img.title }}</h2>
            <p class="text-gray-400 text-sm">Uploaded on {{ img.uploaded_at|date:"d M Y" }}</p>
        </div>
    </a>
    {% empty %}
    <p class="text-center text-gray-400 col-span-full">No photos uploaded yet.</p>
    {% endfor %}
</div>
<div class="text-center mt-6">
    <a href="{% url 'upload_image' %}"
        class="bg-yellow-400 hover:bg-yellow-500 text-black font-semibold py-2 px-4 rounded fixed bottom-[30px] left-1/2 -translate-x-1/2   ">
        Upload Another Photo
    </a>
</div>
{% endblock %}


<!-- Pagination -->
<div class="mt-6 flex justify-center space-x-2">
    {% if page_obj.has_previous %}
    <a href="?{% if request.GET.filter %}filter={{ request.GET.filter }}&{% endif %}{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}page={{ page_obj.previous_page_number }}"
        class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded">Previous</a>
    {% endif %}

    <span class="px-4 py-2 bg-gray-800 text-white rounded">{{ page_obj.number }} of {{ page_obj.paginator.num_pages
        }}</span>

    {% if page_obj.has_next %}
    <a href="?{% if request.GET.filter %}filter={{ request.GET.filter }}&{% endif %}{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}page={{ page_obj.next_page_number }}"
        class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded">Next</a>
    {% endif %}
</div>